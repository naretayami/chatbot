{% extends "layout.html" %}
{% block time %}

<h1>ChatBot</h1>

<h3><a class="logout" href="/logout">ログアウト</a></h3>

<h3>{{ name }}さん、ようこそ。</h3>

<div class="boxed">
  <div>
    <div id="chatbox">
      <img herf="{{ url_for('static',filename='images/kuma.png') }}" alt="くま"></img>
      <p class="botText">
        <span>こんにちは。何か話しかけてみてね </span>
      </p>
    </div>
  </div>
  <div id="userInput">
    <input id="textInput" type="text" name="msg" placeholder="ここに記入" />
  </div>

  <script>
    function getBotResponse() {
      var rawText = $("#textInput").val();
      var userHtml = '<p class="userText"><span>' + rawText + "</span></p>";
      $("#textInput").val("");
      $("#chatbox").append(userHtml);
      document
        .getElementById("userInput")
        .scrollIntoView({ block: "start", behavior: "smooth" });
      $.get("/get", { msg: rawText }).done(function (data) {
        var botHtml = '<p class="botText"><span>' + data + "</span></p>";
        $("#chatbox").append(botHtml);
        document
          .getElementById("userInput")
          .scrollIntoView({ block: "start", behavior: "smooth" });
      });
    }
    $("#textInput").keypress(function (e) {
      if (e.which == 13) {
        getBotResponse();
      }
    });
  </script>

  <script type=text/javascript herf="{{ url_for('static', filename='js/index.js') }}">
    var nowtime_doc = document.getElementById("nowtime");
    nowtime_doc.innerHTML = "TIME " + get_message();
  </script>
</div>
{% endblock %}